{"version":3,"file":"bundle.js","sources":["../src/charts/utils.ts","../src/charts/Bar.ts","../src/demo.ts"],"sourcesContent":["/**\n * 获取 element 的 content 宽度\n * @param element \n */\nexport function getElementContentWidth(element: Element): number {\n\tconst styles = window.getComputedStyle(element);\n\tconst padding = parseFloat(styles.paddingLeft) + parseFloat(styles.paddingRight);\n\treturn element.clientWidth - padding;\n}\n\n/**\n * 保留两位小数\n * @param number\n */\nexport function floatTwo(number: number) {\n\treturn parseFloat(number.toFixed(2));\n}\n\n/**\n * dom 方法\n */\nexport const $ = {\n\tselect: (expr: string | Element, con?: Element): Element => {\n\t\treturn typeof expr === \"string\"? (con || document).querySelector(expr) : expr || null;\n\t},\n\t// <T extends keyof HTMLElement>\n\tcreate: (tag: string, options: any): HTMLElement => {\n\t\tconst element = document.createElement(tag);\n\t\tfor (var key in options) {\n\t\t\tconst value = options[key];\n\t\t\tif (key in element) {\n\t\t\t\t(element as any)[key] = value;\n\t\t\t}\n\t\t}\n\t\treturn element;\n\t},\n\tcreateSVG: (tag: string, options: any): SVGElement => {\n\t\tconst element = document.createElementNS(\"http://www.w3.org/2000/svg\", tag);\n\n\t\tfor (var key in options) {\n\t\t\tconst value = options[key];\n\t\t\tif (key === \"className\") {\n\t\t\t\tkey = \"class\";\n\t\t\t}\n\t\t\tif (key === \"inside\") {\n\t\t\t\t$.select(value).appendChild(element);\n\t\t\t} else if (key === \"innerHTML\") {\n\t\t\t\telement['textContent'] = value;\n\t\t\t} else {\n\t\t\t\telement.setAttribute(key, value);\n\t\t\t}\n\t\t}\n\t\treturn element;\n\t}\n}","import { getElementContentWidth, floatTwo, $ } from \"src/charts/utils\";\n\n/**\n * 分层的解耦思想\n * 数据层 (可以更换算法) -> 渲染层 (可以更换渲染方式)\n * 好处，方便兼容与替换，方便测试\n * 坏处，自制驱动引擎？动画\n */\n\n/** 图默认高度 */\nconst DEFAULT_HEIGHT = 240; \n\n/**\n * 根据最大最小值确定分度，原来代码这部分做得太啰嗦\n * 问题抽象，在已知最大值与最小值的情况下，不限制间隔与数量的情况下，如何让坐标轴刻度尽可能美观\n * G2 实现也很啰嗦 https://github.com/antvis/g2/blob/724872cee56d7e731b1d945444b7b10d4d0ef2e8/src/scale/auto/number.js\n * 想到一个 简单方法，最大值 - 最小值差值 / 4 向上取整数量级\n * @param maxValue \n * @param minValue \n */\nfunction calcIntervals(maxValue: number, minValue: number): number[] {\n  const ticks = [];\n  // 始终以 0 为基准，\n  const diff = minValue > 0 ? maxValue : maxValue - minValue;\n  const initInterval = diff / 6;\n  const exp = Math.floor(Math.log10(initInterval));\n  const finalInterval = Math.ceil(initInterval / Math.pow(10, exp)) * Math.pow(10, exp);\n\n  let downCount = 0;\n  while (0 - downCount * finalInterval >= minValue) {\n    ticks.unshift(0 - downCount * finalInterval);\n    downCount++;\n  }\n  if (minValue <= 0) {\n    ticks.unshift(0 - downCount * finalInterval);\n  }\n  let upCount = 0;\n  while (0 + upCount * finalInterval <= maxValue) {\n    if (!(ticks[ticks.length - 1] === 0 && 0 + upCount * finalInterval === 0)) {\n      ticks.push(0 + upCount * finalInterval);\n    }\n    upCount++;\n  }\n  if (maxValue >= 0) {\n    ticks.push(0 + upCount * finalInterval);\n  }\n\n  return ticks.reverse();\n}\n\n// console.log(calcIntervals(200, 20));\n// console.log(calcIntervals(-100, -1000));\n\ninterface Data {\n  labels: string[],\n  datasets: Array<{\n    title: string,\n    values: number[],\n  }>,\n}\n\ninterface BarChartConfig {\n  /** 外部容器 */\n  parent: string | Element;\n  /** 图表高度 */\n  height?: number;\n  /** 图表数据 */\n  data?: Data;\n  /** 颜色数据 */\n  colors: string[];\n}\n\ninterface XAxisUnit {\n  /** 柱状图开始点 */\n  startBarPos: number;\n  /** bar 宽度 */\n  barWidth: number;\n  /** 中心点 */\n  centerPos: number;\n  /** 处理后，超出 unit 区域 ... */\n  text: string;\n  /** 新-老的差值，中心点 */\n  diffCenterPos?: number;\n}\n\nclass XAxis {\n  /** 单元宽度 */\n  unitWidth: number;\n  /** 轴高度 */\n  axisHeight = 6;\n  /** x轴高度 */\n  height = 40;\n  /** 两侧空隙 */\n  padding = 80;\n  /** 每个单元的位置 */\n  unitList: XAxisUnit[] = [];\n}\n\nclass YAxisUnit {\n  /** 处理后，部分太大，科学计数法 */\n  text: string;\n  /** 竖直位置 */\n  pos: number;\n  /** 新-老的差值，竖直位置 */\n  diffPos?: number;\n}\n\nclass YAxis {\n  /** 分度值List */\n  ticks: number[] = [];\n  /** 起始位置，与 text 的长短有关 */\n  startPos: number;\n  /** 结束位置 */\n  endPos: number;\n  /** 每个单元的位置 */\n  unitList: YAxisUnit[] = [];\n  /** 零轴位置 */\n  zeroPos: number;\n  /** 每个长度代表的value */\n  valueInterval: number;\n}\n\ninterface DataPos {\n  value: number;\n  startX: number;\n  startY: number;\n  width: number;\n  height: number;\n  /** 新-老的差值，y 轴方向上 */\n  diff?: number;\n}\n\nclass BarChart {\n  xAxisGroup: SVGElement;\n  yAxisGroup: SVGElement;\n  svg: SVGElement;\n  chartWrapper: any;\n  container: HTMLElement;\n  data: Data;\n  config: BarChartConfig;\n  parent: Element;\n  /** 是否已存在值，已存在就要触发 animation */\n  isExist: boolean;\n  dataPos: DataPos[][];\n\n  width: number;\n  height: number;\n\n  xAxis: XAxis = new XAxis();\n  yAxis: YAxis = new YAxis();\n\n  constructor(config: BarChartConfig) {\n    this.config = config;\n    this.calculate();\n    this.isExist = true;\n    this.render();\n  }\n\n  /**\n   * 计算模块\n   */\n  calculate() {\n    this.getSize();\n    this.getAxis();\n    this.getValue();\n  }\n\n  /**\n   * 渲染模块\n   */\n  render() {\n    this.renderContainer();\n    this.renderAxis();\n    this.renderValue();\n  }\n\n  /**\n   * 更新模块\n   */\n  update(data: Data) {\n    // this.calculate();\n  }\n\n  /**\n   * 设置图表大小，可抽象为 Base\n   */\n  getSize() {\n    // 当前图表已存在，此部不需要再做\n    if (this.isExist) return;\n\n    if (typeof this.config.parent === 'string') {\n      this.parent = document.querySelector(this.config.parent);\n    } else {\n      this.parent = this.config.parent;\n    }\n    this.width = getElementContentWidth(this.parent);\n    this.height = this.config.height || DEFAULT_HEIGHT;\n  }\n\n  /**\n   * 设置坐标轴大小，可抽象为 Axis\n   */\n  getAxis() {\n    this.data = this.config.data;\n\n    // x 轴\n    this.xAxis.unitWidth = (this.width - this.xAxis.padding * 2) / this.data.labels.length;\n    const charWidth = 8;\n    const barWidth = this.xAxis.unitWidth * (2 / 3) / (this.data.datasets.length);\n    this.xAxis.unitList = this.data.labels.map((label, i) => {\n      // 需要考虑 label 过长的情况，获取字符串的长度\n      const labelWidth = label.length * charWidth;\n      const centerPos = floatTwo(i * this.xAxis.unitWidth + this.xAxis.padding + this.xAxis.unitWidth / 2);\n      return {\n        barWidth,\n        startBarPos: i * this.xAxis.unitWidth + this.xAxis.padding + this.xAxis.unitWidth * (1 / 3) / 2,\n        centerPos,\n        text: labelWidth > this.xAxis.unitWidth ? `${label.slice(0, this.xAxis.unitWidth / charWidth)}...` : label,\n        // 当前存在，则发生偏移，不存在的直接出现\n        // diffCenterPos: this.xAxis.unitList.length - 1 > i ? this.xAxis.unitList[i].centerPos - centerPos : 0,\n      };\n    });\n\n    // y 轴\n    // 合并所有 y 值，求解最大、最小值\n    const allValues = this.data.datasets.reduce((pre, dataset) => {\n      return [ ...pre, ...dataset.values ];\n    }, []);\n\n    const maxValue = Math.max(...allValues);\n    const minValue = Math.min(...allValues);\n\n    // padding 为 x 轴高度\n    const padding = this.xAxis.height;\n\n    const oldTicks = [...this.yAxis.ticks];\n    this.yAxis.ticks = calcIntervals(maxValue, minValue);\n    const heightInterval = (this.height - padding * 2) / (this.yAxis.ticks.length - 1);\n    this.yAxis.valueInterval = (this.height - padding * 2) / (this.yAxis.ticks[0] - this.yAxis.ticks[this.yAxis.ticks.length - 1]);\n\n    // 最大的开始位置\n    const statPosLimit = this.xAxis.padding;\n    const maxTick = Math.max(Math.abs(this.yAxis.ticks[0]), Math.abs(this.yAxis.ticks[this.yAxis.ticks.length - 1]));\n    const maxTickLength = String(maxTick).length * charWidth;\n    this.yAxis.startPos = (statPosLimit < maxTickLength ? statPosLimit : maxTickLength) + 10;\n    this.yAxis.endPos = this.width - this.yAxis.startPos * 2;\n\n    this.yAxis.unitList = this.yAxis.ticks.map((tick, index) => {\n      // @Todo 太长考虑用科学计数法代替\n      if (tick === 0) {\n        this.yAxis.zeroPos = padding + heightInterval * index;\n      }\n      return {\n        pos: padding + heightInterval * index,\n        text: String(tick),\n        // diffPos:\n      };\n    });    \n  }\n\n  /** 设置各个值在 x 轴与 y 轴的真实位置 */\n  getValue() {\n    this.dataPos = this.data.datasets.map((dataset, index) => {\n      const { values } = dataset;\n      return values.map((value, i) => {\n        const { barWidth, startBarPos } = this.xAxis.unitList[i];\n        const startX = startBarPos + barWidth * index;\n        const height = Math.abs(value) * this.yAxis.valueInterval;\n        if (value < 0) {\n          return {\n            value: value,\n            startX,\n            startY: this.yAxis.zeroPos,\n            width: barWidth,\n            height,\n          };\n        }\n        return {\n          value: value,\n          startX,\n          startY: this.yAxis.zeroPos - height,\n          width: barWidth,\n          height,\n        }\n      });\n    });\n  }\n\n  /** 渲染外容器 */\n  renderContainer() {\n    this.container = $.create('div', {\n      className: 'chart-container',\n      innerHTML: `<div class=\"frappe-chart graphics\"></div>`,\n    });\n    this.parent.innerHTML = '';\n    this.parent.appendChild(this.container);\n\n    this.chartWrapper = this.container.querySelector('.frappe-chart');\n\n    this.svg = $.createSVG('svg', {\n      className: 'chart',\n      inside: this.chartWrapper,\n      width: this.width,\n      height: this.height,\n    });\n  }\n\n  /** 渲染坐标 */\n  renderAxis() {\n    // 渲染 y 轴坐标\n    this.yAxisGroup = $.createSVG('g', {\n      className: 'y-axis',\n      inside: this.svg,\n    });\n\n    this.yAxis.unitList.forEach((unit, index) => {\n      const { pos, text } = unit;\n\n      const yAxisTick = $.createSVG('g', {\n        className: 'y-axis-tick',\n        inside: this.yAxisGroup,\n        transform: `translate(0, ${pos})`,\n      });\n\n      const yAxisLine = $.createSVG('line', {\n        className: text === '0' ? 'y-axis-line y-axis-line-zero' : 'y-axis-line',\n        x1: this.yAxis.startPos,\n        x2: this.yAxis.endPos,\n        y1: 0,\n        y2: 0\n      });\n\n      const yAxisText = $.createSVG('text', {\n        className: 'y-axis-text',\n        x: this.yAxis.startPos - 6,\n        y: 0,\n        dy: '.32em',\n        innerHTML: text,\n      });\n\n      yAxisTick.appendChild(yAxisLine);\n      yAxisTick.appendChild(yAxisText);\n    });\n\n    // 渲染 x 轴坐标\n    this.xAxisGroup = $.createSVG('g', {\n      className: 'x-axis',\n      inside: this.svg,\n      transform: `translate(0, ${this.height - this.xAxis.height})`,\n    });\n\n    this.xAxis.unitList.forEach((unit, index) => {\n      const { centerPos, text } = unit;\n\n      const xAxisTick = $.createSVG('g', {\n        className: 'x-axis-tick',\n        inside: this.xAxisGroup,\n        transform: `translate(${centerPos}, 0)`,\n      });\n      const xAxisLine = $.createSVG('line', {\n        className: 'x-axis-line',\n        x1: 0,\n        x2: 0,\n        y1: 0,\n        y2: this.xAxis.axisHeight,\n      });\n      const xAxisText = $.createSVG('text', {\n        className: 'x-axis-text',\n        innerHTML: text,\n        x: 0,\n        dy: '.9em',\n        y: this.xAxis.axisHeight,\n      });\n\n      xAxisTick.appendChild(xAxisLine);\n      xAxisTick.appendChild(xAxisText);\n    });    \n  }\n\n  renderValue() {\n    this.dataPos.forEach((data, index) => {\n      const color = this.config.colors[index];\n      const dataG = $.createSVG('g', {\n        className: 'data-points',\n        inside: this.svg,\n      });\n      data.forEach(pos => {\n        const { value, startX, startY, width, height } = pos;\n        const dataRect = $.createSVG('rect', {\n          className: 'bar',\n          x: startX,\n          y: startY,\n          width,\n          height,\n          fill: color,\n        });\n\n        dataG.appendChild(dataRect);\n      });\n    });\n  }\n}\n\nexport default BarChart;\n\n","import Chart from './index';\nimport BarChart from './charts/Bar';\n\nconst data = {\n  labels: [\n    '12am-3am',\n    '3am-6pm',\n    '6am-9am',\n    '9am-12am',\n    '12pm-3pm',\n    '3pm-6pm',\n    '6pm-9pm',\n    '9am-12am'\n  ],\n  datasets: [\n    {\n      title: 'Some Data',\n      values: [25, 40, 30, 35, 8, 52, 17, -4]\n    },\n    {\n      title: 'Another Set',\n      values: [25, 50, -10, 15, 18, 32, 27, 14]\n    },\n    {\n      title: \"Yet Another\",\n      values: [15, 20, -3, -15, 58, 12, -17, 37]\n    }\n  ]\n};\n\n/*\nconst chart = new Chart({\n  parent: 'line',\n  title: 'My Chart',\n  data: data,\n  type: 'line', // or 'line', 'scatter', 'pie', 'percentage'\n  height: 250,\n  colors: ['#7cd6fd', '#743ee2']\n});\n*/\n\nconst chart = new BarChart({\n  parent: document.getElementById('barchart'),\n  height: 300,\n  colors: ['#7cd6fd', '#743ee2', '#5e64ff'],\n  data,\n});"],"names":[],"mappings":"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"}